---
title: "1992 U.S. Presidential election"
author: "Ali Seada and Paul Lovis Maximilian Trüstedt" # !!more names
date: "24 6 2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read the data into R environment
```{r}
library(pacman)
p_load(ggplot2,   # reportable graphs 
       cowplot,   # arranges ggplot graphs nicely
       stargazer, # nice tables
       glmnet,    # for regularization (lasso, ridge, elastic net)
       pROC)      # ROC AUC
rm(list=ls())
vote<-read.csv("vote92.csv")
str(vote)
summary(vote)
```

## Preprocess the data, preparing it for the modeling
```{r}
vote$dem <-as.factor(vote$dem)
vote$rep <-as.factor(vote$rep)
vote$female <-as.factor(vote$female)
vote$persfinance <-as.factor(vote$persfinance)
vote$natlecon <-as.factor(vote$natlecon)
# ??should be numeric by definition in doc LETS SEE
str(vote)
```
We decided to change some of the numeric variables to factors, because it makes more sense to have them as factors than as numeric variables.

- treat missing values
```{r}
vote[vote==-999|vote==""]<-NA
colSums(is.na(vote))
```
There are no missing values in this data set

- handle sparse classes of categorical predictors
```{r}
table(vote$vote)
table(vote$dem)
table(vote$rep)
table(vote$female)
table(vote$persfinance)
table(vote$natlecon) # ?? leave fusion of 0 and 1, technically sparse
vote$natlecon[vote$natlecon==1]<-0
vote$natlecon[vote$natlecon==-1]<-1
vote$natlecon=droplevels(vote$natlecon)
table(vote$natlecon)
```
X The categorical variables are simplified enough and don't need anything else to be done to them.
OR IF UPDATE LEFT
O We leave everything as is except for natlecon which has a sparse class regarding the level 1.
As solution we combine 0 and 1 as the level 0, meaning national economic conditions have gotten better or stayed the same over the last 12 months. Level -1 gets changed to 1 as well which now means that conditions have gone better. \
The change from -1 to 1 is executed just because it is more common to have levels 0 and 1 instead of 0 and -1.

- take care of outliers, treat the skewed distributions and create new features 
```{r}
zScores <- function(var){
    mu <- mean(var)
    sd <-  sd(var)
    scores <- (var - mu)/sd
    return(scores)
}

# treating clintondis
ggplot(vote,aes(clintondis))+geom_density() # ??is this considered skewed; ??also very common
tp1<-ggplot(vote,aes(clintondis))+geom_boxplot()+coord_flip()
vote$clintondis_fo<-vote$clintondis
vote$clintondis_fo[zScores(vote$clintondis_fo)>1]<-
    round(mean(vote$clintondis_fo))+sd(vote$clintondis_fo)
tp2<-ggplot(vote,aes(clintondis_fo))+geom_boxplot()+coord_flip()
plot_grid(tp1,tp2,ncol=2)

# !!make this shit beautiful
# !!reduce the outlier fixes with function
# ??passable results
```
___INSERT___

```{r}
# treating bushdis
tp1<-ggplot(vote,aes(bushdis))+geom_boxplot()+coord_flip()
vote$bushdis_fo<-vote$bushdis
vote$bushdis_fo[zScores(vote$bushdis_fo)>2]<-
    round(mean(vote$bushdis_fo))+2*sd(vote$bushdis_fo)
tp2<-ggplot(vote,aes(bushdis_fo))+geom_boxplot()+coord_flip()
plot_grid(tp1,tp2,ncol=2)
```
___INSERT___

```{r}
# treating perotdis
tp1<-ggplot(vote,aes(perotdis))+geom_boxplot()+coord_flip()
vote$perotdis_fo<-vote$perotdis
vote$perotdis_fo[zScores(vote$perotdis_fo)>1]<-
    round(mean(vote$perotdis_fo))+sd(vote$perotdis_fo)
tp2<-ggplot(vote,aes(perotdis_fo))+geom_boxplot()+coord_flip()
plot_grid(tp1,tp2,ncol=2)
```
___INSERT___

- explore the relationships between predictors and the target
```{r}
tcs<-vote$dem
tcs[tcs==1]<-vote$rep[vote$rep==1] # §§tiny prototype of future way of presentation
ggplot(vote,aes(vote,fill=dem))+geom_bar()
```
___INSERT___